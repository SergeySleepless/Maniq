//
//  CheckCodeViewController.swift
//  Maniq
//
//  Created by –°–µ—Ä–≥–µ–π –ì–∞–≤—Ä–∏–ª–æ–≤ on 02.02.2020.
//  Copyright (c) 2020 –°–µ—Ä–≥–µ–π –ì–∞–≤—Ä–∏–ª–æ–≤. All rights reserved.
//
//  This file was generated by the üêç VIPER generator
//

import UIKit
import CBPinEntryView

final class CheckCodeViewController: UIViewController {

    // MARK: - Public properties -

    var presenter: CheckCodePresenterInterface!
    var number: String!

    @IBOutlet weak var titleLabel: UILabel!
    @IBOutlet weak var pinEntryView: CBPinEntryView!
    
    // MARK: - Lifecycle -

    override func viewDidLoad() {
        super.viewDidLoad()
        
        configurePinEntryView()
        configureTitle()
        setTitle(title: "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è")
    }
    
    private func configurePinEntryView() {
        pinEntryView.becomeFirstResponder()
        pinEntryView.allowedEntryTypes = .numerical
        pinEntryView.keyboardType = 4
        pinEntryView.delegate = self
    }
    
    private func configureTitle() {
        titleLabel.text = "–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ –Ω–æ–º–µ—Ä \(number!)"
    }
	
}

// MARK: - Extensions -

extension CheckCodeViewController: CheckCodeViewInterface {
    
    func setError() {
        pinEntryView.setError(isError: true)
    }
}

extension CheckCodeViewController: CBPinEntryViewDelegate {
    func entryChanged(_ completed: Bool) {
        pinEntryView.setError(isError: false)
    }
    
    func entryCompleted(with entry: String?) {
        presenter.signIn(code: entry!)
    }
}
